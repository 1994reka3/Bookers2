<div class="container">
  <div class="row">
    <!-- エラーメッセージ -->
    <%= render 'books/error', newbook: @book %>
    <div class="col-xs-3">
      <!-- User_info部分テンプレート -->
      <div class="row">
        <%= render 'users/user_info', user: @user %>
      </div>
      <!-- New_book部分テンプレート -->
      <div class="row">
        <%= render 'books/newbook', newbook: @book %>
      </div>
    </div>
    <!-- 投稿された本の一覧 -->
    <div class="col-xs-9">
    <h2>Books</h2>
    <table class="table table-hover">
    <thead>
      <tr>
        <th></th>
        <th>Title</th>
        <th>Opinion</th>
        <th></th>  <!--　いいね部分 -->
      </tr>
    </thead>
    <tbody>
      <% @books.each do |book| %>
      <tr>
        <td>
          <%= link_to user_path(book.user_id) do %>
            <%= attachment_image_tag book.user, :profile_image, format: 'jpeg', fallback: "no_image.jpg", size: "60x60" %>
          <% end %>
        </td>
        <td><%= link_to book.title, book_path(book.id) %></td>
        <td><%= book.body %></td>
        <!-- いいね部分 -->
        <% if book.favorited_by?(current_user) %>
          <td>
            <%= link_to book_favorites_path(book), method: :delete do %>
              <i class="fas fa-heart" aria-hidden="true" style="color: red;"></i>
              <%= book.favorites.count %>
            <% end %>
          </td>
        <% else %>
          <td>
            <%= link_to book_favorites_path(book), method: :post do %>
              <i class="far fa-heart" aria-hidden="true"></i>
              <%= book.favorites.count %>
            <% end %>
          </td>
        <% end %>
        <!-- コメント数 -->
        <td>コメント数: <%= book.book_comments.count %></td>
      </tr>
      <% end %>
    </tbody>
    </table>
    </div>
  </div>
</div>

